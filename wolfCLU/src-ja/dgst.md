### DGST コマンド — メッセージダイジェストおよびデジタル署名操作

`wolfssl dgst` コマンドは、暗号学的メッセージダイジェスト（ハッシュ）の計算、
および入力データに対する **デジタル署名の生成および検証** を行うために使用されます。

本コマンドは OpenSSL の `openssl dgst` コマンドと同様の機能を提供します。
コマンドラインの **最後の引数** には、ハッシュ化または署名対象となる入力データを指定します。

主な用途は以下のとおりです。

- 入力データのメッセージダイジェスト（ハッシュ）計算
- 秘密鍵を用いたデジタル署名の生成
- 公開鍵または証明書を用いたデジタル署名の検証

---

#### 機能概要

`dgst` コマンドは任意の入力データを対象として動作し、
複数のハッシュアルゴリズムをサポートします。

指定されるオプションに応じて、以下の操作を行います。

- **ダイジェスト計算**
  - 入力データに対するハッシュ値を計算
- **署名生成**
  - 秘密鍵を使用して入力データに対するデジタル署名を生成
- **署名検証**
  - 公開鍵または証明書を使用してデジタル署名を検証

入力データは、コマンドラインの **最後の引数** として指定します。

---

#### サポートされているハッシュアルゴリズム

以下のメッセージダイジェストアルゴリズムがサポートされています。

- `-md5`
- `-sha`
- `-sha224`
- `-sha256`
- `-sha384`
- `-sha512`

ハッシュアルゴリズムが明示的に指定されていない場合、
ビルド構成に応じてデフォルトのアルゴリズムが使用されることがあります。

---

#### 共通オプション

| オプション | 説明 |
|------|-------------|
| `-inform pem \| der` | 鍵ファイルまたは署名ファイルの入力形式 |
| `-out <file>` | 生成された署名またはダイジェストの出力先 |

---

#### 署名生成オプション

以下のオプションは、デジタル署名を生成する場合に使用します。

| オプション | 説明 |
|------|-------------|
| `-sign <file>` | 署名生成に使用する秘密鍵 |

`-sign` が指定された場合、入力データに対して署名が生成され、
`-out` で指定されたファイルに出力されます。

---

#### 署名検証オプション

以下のオプションは、既存のデジタル署名を検証する場合に使用します。

| オプション | 説明 |
|------|-------------|
| `-signature <file>` | 検証対象となる署名ファイル |
| `-verify <file>` | 検証に使用する公開鍵または証明書 |

`-signature` と `-verify` の両方が指定された場合、
入力データに対して署名の検証が行われます。

---

#### 注意事項

- ハッシュ化または署名対象となる入力データは、
  コマンドラインの **最後の引数** として指定する必要があります。
- `-sign` と `-verify` オプションは同時に指定できません。
- 署名検証時の結果は標準出力に表示されます。
- 鍵ファイルおよび署名ファイルの形式は、
  `-inform` で指定した形式と一致している必要があります。

---

#### 例

秘密鍵を使用してデジタル署名を生成する例:

```sh
wolfssl dgst -sha256 -sign keyPrivate.pem -out data.sig data.txt
```

デジタル署名を検証する例:

```sh
wolfssl dgst -sha256 -signature data.sig -verify keyPublic.pem data.txt
```
メッセージダイジェストを計算する例:

```sh
wolfssl dgst -sha256 data.txt
```
