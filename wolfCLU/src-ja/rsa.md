### RSA コマンド — RSA 鍵の処理および内容確認

`wolfssl rsa` コマンドは、RSA 鍵の **読み込み、内容確認、形式変換、および情報抽出**
を行うために使用されます。

本コマンドは OpenSSL の `openssl rsa` コマンドと同様の機能を提供し、
PEM または DER 形式の RSA 秘密鍵および公開鍵の両方をサポートします。

主な用途は以下のとおりです。

- RSA 鍵の PEM / DER 形式変換
- RSA 鍵構成要素の表示
- RSA モジュラスの抽出
- 暗号化された PEM 形式秘密鍵の処理
- 公開鍵および秘密鍵の表現変換

---

#### 機能概要

`rsa` コマンドは、既存の RSA 鍵を対象として以下の操作をサポートします。

- RSA 秘密鍵または公開鍵の読み込み
- 鍵エンコード形式の変換（PEM ↔ DER）
- 秘密鍵から公開鍵を出力
- モジュラスなどの RSA パラメータの表示
- パスワードで保護された PEM 形式秘密鍵の処理

コマンドの挙動は、入力された鍵が秘密鍵か公開鍵か、
および指定されたオプションによって決まります。

---

#### 入出力

- **入力**
  - RSA 秘密鍵または公開鍵（PEM または DER）
- **出力**
  - RSA 秘密鍵または公開鍵（PEM または DER）、または指定された鍵情報

---

#### 共通オプション

| オプション | 説明 |
|------|-------------|
| `-in <file>` | RSA 鍵を含む入力ファイル |
| `-inform PEM \| DER` | 入力鍵の形式 |
| `-out <file>` | 出力ファイル（省略時は標準出力） |
| `-outform PEM \| DER` | 出力鍵の形式 |
| `-passin <source>` | 暗号化された PEM 秘密鍵のパスワード |
| `-noout` | 鍵本体を出力しない |

---

#### 公開鍵・秘密鍵の取り扱いオプション

以下のオプションは、入力鍵および出力鍵の扱い方を制御します。

| オプション | 説明 |
|------|-------------|
| `-RSAPublicKey_in` | RSAPublicKey 形式の RSA 公開鍵が入力されることを指定 |
| `-pubin` | 公開鍵が入力されることを指定 |
| `-pubout` | 秘密鍵の代わりに公開鍵を出力 |

> **注意:**  
> `-RSAPublicKey_in` および `-pubin` は、
> 入力が公開鍵であることを明示的に指定するために使用されます。

---

#### RSA パラメータ出力オプション

| オプション | 説明 |
|------|-------------|
| `-modulus` | RSA モジュラス（`n` 値）を表示 |

`-modulus` が指定された場合、モジュラス値は
16 進数形式で表示されます。

---

#### 注意事項

- `-pubin` および `-RSAPublicKey_in` のいずれも指定されていない場合、
  入力は RSA 秘密鍵であると仮定されます。
- 暗号化された PEM 形式の秘密鍵を処理する場合、
  `-passin` オプションの指定が必要です。
- `-noout` オプションを指定すると、
  鍵本体の出力は抑制されますが、
  `-modulus` などのパラメータ出力は可能です。
- 本コマンドは RSA 鍵の生成は行いません。
  鍵生成には `genkey` コマンドを使用してください。

---

#### 例

PEM 形式の RSA 秘密鍵を DER 形式に変換する例:

```sh
wolfssl rsa -in rsa-key.pem -inform PEM -outform DER -out rsa-key.der
```

RSA モジュラスを表示する例:

```sh
wolfssl rsa -in rsa-key.pem -modulus -noout
```

秘密鍵から公開鍵を抽出する例:

```sh
wolfssl rsa -in rsa-key.pem -pubout -out rsa-pub.pem
```

RSA 公開鍵を読み込み、出力する例:

```sh
wolfssl rsa -pubin -in rsa-pub.pem -outform PEM
```
