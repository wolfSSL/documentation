### CA コマンド — 認証局による署名および証明書発行

`wolfssl ca` コマンドは、
**証明書署名要求（Certificate Signing Request: CSR）** を署名し、
X.509 証明書を発行するための、基本的な **認証局（Certificate Authority: CA）**
機能を提供します。

本コマンドは OpenSSL の `openssl ca` コマンドと類似した機能を持ちますが、
一般的な証明書署名処理に焦点を当てた、簡易的な機能セットとなっています。
CA 証明書とその秘密鍵を用いた CSR の署名に加え、
自己署名証明書の生成もサポートしています。

主な用途は以下のとおりです。

- CA の秘密鍵を用いて CSR を署名し、X.509 証明書を発行
- 設定ファイルから証明書拡張を適用
- 証明書の有効期間および署名アルゴリズムの制御
- テスト用途や内部利用のための自己署名証明書の生成

---

#### 機能概要

`ca` コマンドは CSR を入力として受け取り、
署名済みの X.509 証明書を生成します。

指定されたオプションに応じて、以下の動作モードをサポートします。

- **CA 署名証明書の生成**
  - CA 証明書およびそれに対応する秘密鍵を使用して CSR を署名
- **自己署名証明書の生成**
  - 入力証明書に対応する秘密鍵を使用して証明書を署名（`-selfsign`）

本コマンドは、証明書拡張やその他の証明書関連パラメータを
設定ファイルから読み取って処理します。

---

#### 入出力

- **入力**
  - 証明書署名要求（CSR）
- **出力**
  - X.509 証明書（PEM または DER）

---

#### 共通オプション

| オプション | 説明 |
|------|-------------|
| `-in <file>` | 入力 CSR ファイル |
| `-out <file>` | 生成される証明書の出力先 |
| `-inform PEM \| DER` | CSR の入力形式 |
| `-outform PEM \| DER` | 証明書の出力形式 |
| `-config <file>` | 証明書パラメータを定義した設定ファイル |
| `-days <n>` | 証明書の有効日数 |
| `-md <hash>` | 署名に使用するメッセージダイジェストアルゴリズム（例: `sha256`） |

---

#### CA 鍵および証明書オプション

以下のオプションは、証明書署名に使用する CA の認証情報を指定します。

| オプション | 説明 |
|------|-------------|
| `-keyfile <file>` | 証明書署名に使用する秘密鍵 |
| `-cert <file>` | 上記秘密鍵に対応する CA 証明書 |

---

#### 拡張処理オプション

| オプション | 説明 |
|------|-------------|
| `-extensions <section>` | 設定ファイル内で証明書拡張を読み取るセクション名 |

---

#### 自己署名証明書オプション

| オプション | 説明 |
|------|-------------|
| `-selfsign` | 入力証明書に対応する秘密鍵を使用して自己署名する |

> **注意:**  
> `-selfsign` を指定した場合、証明書は独立した CA 鍵ではなく、
> 自身の鍵を用いて署名されます。

---

#### 注意事項

- `-in` で指定する入力ファイルは、有効な CSR である必要があります。
- CA 署名証明書を生成する場合、`-keyfile` と `-cert` の両方を指定する必要があります。
- 拡張情報の解析は、基本的な設定ファイル処理に限定されています。
- OpenSSL の完全な `ca` コマンドとは異なり、
  本コマンドは証明書データベースやシリアル番号ファイルの管理は行いません。

---

#### 例

CA 証明書と秘密鍵を用いて CSR を署名する例:

```sh
wolfssl ca \
  -config ca.conf \
  -in server.csr \
  -out server-cert.pem \
  -cert ca-cert.pem \
  -keyfile ca-key.pem \
  -md sha256 \
  -days 365
```

自己署名証明書を生成する例:

```sh
wolfssl ca \
  -config selfsign.conf \
  -in server.csr \
  -out server-cert.pem \
  -selfsign \
  -md sha256 \
  -days 365
```
