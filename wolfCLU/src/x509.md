### X509 Command — Certificate Parsing, Inspection, and Signing

The `wolfssl x509` command is a general-purpose utility for working with X.509 certificates and
Certificate Signing Requests (CSRs).

This command supports **two distinct operating modes**, and its behavior changes significantly
depending on whether the `-req` option is specified:

- **Certificate Parsing and Inspection Mode (default)**
- **CSR Processing and Certificate Generation Mode (`-req`)**

The interface and overall behavior are intentionally similar to OpenSSL’s `openssl x509` command,
while internally relying on wolfSSL’s X.509 parsing and certificate handling implementation.

Typical use cases include:

- Converting X.509 certificates between PEM and DER formats
- Inspecting certificate contents (Subject, Issuer, validity period, public key, etc.)
- Printing certificate metadata such as serial numbers, fingerprints, and hashes
- Generating and signing X.509 certificates from a CSR

---

#### Operating Modes

##### Certificate Parsing and Inspection Mode (default)

When the `-req` option is **not** specified, the input file is treated as an **X.509 certificate**.
In this mode, the command is primarily used for parsing, inspecting, and converting existing
certificates.

Common operations include:

- Printing human-readable certificate details
- Extracting specific certificate fields (Subject, Issuer, validity dates, etc.)
- Outputting the public key or RSA modulus
- Converting certificates between PEM and DER formats

This mode does **not** perform certificate signing.

##### Common Options

| Option | Description |
|------|-------------|
| `-inform pem \| der` | Input certificate format |
| `-in <file>` | Input certificate file |
| `-outform pem \| der` | Output certificate format |
| `-out <file>` | Output file |
| `-noout` | Do not output the encoded certificate |
| `-text` | Print the certificate in human-readable form |
| `-subject` | Print the subject distinguished name |
| `-issuer` | Print the issuer distinguished name |
| `-serial` | Print the certificate serial number in hexadecimal |
| `-dates` | Print the certificate validity period |
| `-email` | Print the subject email address |
| `-fingerprint` | Print the certificate fingerprint (hash of DER encoding) |
| `-purpose` | Print the certificate purpose |
| `-hash` | Print the hash of the subject name |
| `-modulus` | Print the RSA public key modulus |
| `-pubkey` | Output the public key |

##### Examples

```sh
wolfssl x509 -in cert.pem -text
wolfssl x509 -in cert.pem -subject -issuer -dates
wolfssl x509 -inform pem -in cert.pem -outform der -out cert.der
```

##### CSR Processing and Certificate Generation Mode (`-req`)

When the `-req` option is specified, the input file is interpreted as a
**Certificate Signing Request (CSR)** instead of a certificate.

In this mode, `wolfssl x509` can be used to:

- Process and inspect a CSR
- Generate and sign an X.509 certificate based on the CSR
- Apply certificate extensions from a configuration file
- Select the digest algorithm used for signing

Options such as `-signkey`, digest selection (`-sha256`, etc.), `-extfile`, and `-extensions`
are meaningful **only in this mode**.

#### Notes

- The meaning of the input file specified by `-in` depends on whether `-req` is present.
- Some options are valid only in one operating mode and are ignored or invalid in the other.
- To generate a CSR itself, use the dedicated `req` command.


#### CSR-Specific Options

The following options are meaningful **only when `-req` is specified**:

| Option | Description |
|------|-------------|
| `-req` | Enable CSR processing mode |
| `-signkey <file>` | Private key used to sign the generated certificate |
| `-*` (e.g. `-sha256`, `-sha384`) | Digest algorithm used for certificate signing |
| `-extfile <file>` | Configuration file containing X.509 extensions |
| `-extensions <section>` | Section name in the configuration file that defines the extensions to apply |

Options related to certificate inspection (such as `-issuer`, `-serial`,
`-dates`, etc.) are generally not applicable in this mode.

---

#### Example

Generate and sign an X.509 certificate from a CSR using SHA-256 and a
configuration file for extensions:

```sh
wolfssl x509 -req \
  -in server.csr \
  -signkey ca-key.pem \
  -sha256 \
  -extfile cert.conf \
  -extensions v3_server \
  -out server-cert.pem
  ```
